### This repository was created by [Pavel Filippenko](https://github.com/pavel-collab), [Mikhail Ovsiannikov](https://github.com/OAMichael) and [Andrey Barannikov](https://github.com/barannikovav).

### Понадобится установить следующее:
```console
pip install psutil
pip install python-libxdo
pip install python-telegram-bot
pip install seaborn
pip install sqlalchemy
pip install faker
pip install PyQt5
sudo apt-get install python3-gi gir1.2-wnck-3.0
```

#### Как запустить
##### На главном компьютере запускается программа `MainServer.py`. На компьютерах работников запускаются программы `Worker.py`. В качестве аргументов командной строки должны присутствовать пути к файлам конфигураций соответственно для сервера и работника. Раз в 5 секунд `Worker.py` получает нужную информацию и отправляет ее на сервер. Сервер же должен обрабатывает эту информацию и записывает в базу данных. Если в конфиге для сервера прописать `bot = True`, то запускается телеграм-бот, через которого босс может запросить информацию о работниках в целом и каком-то конкретном. Вдобавок, на локальном сервере можно запустить программу `QtBase.py`, через которую можно наблюдать всю собранную сервером информацию в виде таблиц.


#### Что скрипт должен делать:
1. Получить информацию о компьютере данного работника
2. Передать ее на главный сервер
3. Сервер обрабатывает данную информацию:
	- Записывает все в базу данных
	- По возможности строит графики нужных величин
	- Выводит информацию по необходмому запросу
4. При запуске `QtBase.py` выводится вся информация о работниках
5. ~~Отсылать всю инфу боссу в телегу~~

#### Что скрипт делает на данный момент:
1. На сервере запускает [**телеграм-бота**](https://t.me/Conntrol_test_bot)
2. Каждый клиент получает следующую информацию о своем компьютере и системе:
	- Для процессов, связанных с открытыми окнами, получает:
		- Name
		- Create time
		- Status
		- RSS memory
		- VMS memory
		- Shared memory
		- Data memory
	- Количество процессов
	- Использование дисковой памяти
	- Частоту CPU (минимальную, максимальную и текущую)
	- Время запуска системы
	- Общее использование памяти
	- Названия всех открытых окон
	- Имя текущего окна
	- Наиболее часто используемое окно и процентаж использования
	- Второе наиболее часто используемое окно и процентаж использования (если есть)
	- Третье наиболее часто используемое окно и процентаж использования (если есть)
3. Вся эта информация передается серверу через TCP протокол. Он записывает все базу данных SQL
4. В телеграм-боте по запросу с помощью команд или интерактивной клавиатуры выдается информация, оговоренная выше, о работнике по имени [Worker name] и присылается картинка с гистограммой не более трех наиболее используемых окон и процентаж использования.

***Замечание 1:*** при запуске программы `MainServer.py` с конфигом `bot = True` запускается дочерний процесс с телеграм-ботом `TGBot.py` (пока что бот жив при условии, что компьютер того, кто запустил `MainServer.py`, включен). Тот в свою очередь бесконечно спит, пока босс пользователь телеграма не запросит информацию. Как только это произошло, `TGBot.py` запускает подпроцесс `Plot.py` и ждет, пока построится и сохранится график, после чего уже отправляет картинку и дополнительную информацию.


***Замечание 2:*** в репозитории есть файлы для классов клиента и сервера: `client.py` и `server.py` соответственно. На данный момент в основную программу полноценно сынтегрирован только класс клиента. Работа по цельному внедрению сервера продолжается.